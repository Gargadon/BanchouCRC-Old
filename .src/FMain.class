' Gambas class file

Public Sub _new()

End

Public Sub Form_Open()

End

Public Sub AnadirCRC_Click()
Dim ShowCRC As String
Dim NuevoNombre As String
Dim NombreArchivo As String = File.BaseName(Dialog.Path)
Dim ExtensionArchivo As String = File.Ext(Dialog.Path)
Dim DireccionArchivo As String = File.Dir(Dialog.Path)
Estado.Text = "Calculando CRC..."
If AbrirArchivo.Text == "Seleccione archivo" Then
  Estado.Text = "Seleccione un archivo."
Else
Try Exec ["crc32", AbrirArchivo.Text] To ShowCRC
If Error Then
  Estado.Text = "No se pudo obtener el CRC32 del archivo, o libarchive-zip-perl no est√° instalado."
Else
  ShowCRC = String.Left(ShowCRC, String.Len(ShowCRC) - 2) 'Aqui eliminamos el salto de linea de CRC32
  ShowCRC = UCase$(ShowCRC)
  NuevoNombre = DireccionArchivo &/ NombreArchivo & " [" & ShowCRC & "]." & ExtensionArchivo
  Estado.Text = "Renombrando archivo..."
  Try Move AbrirArchivo.Text To NuevoNombre 
  If Error Then 
    Try Copy AbrirArchivo.Text To NuevoNombre 
  If Not Error Then Kill AbrirArchivo.Text
Endif 
  Estado.Text = "El archivo ha sido renombrado a " & NombreArchivo & " [" & ShowCRC & "]." & ExtensionArchivo
  AbrirArchivo.Text = "Seleccione archivo"
Endif
Endif
End


Public Sub AbrirArchivo_Click()

If Dialog.OpenFile() Then Return
  AbrirArchivo.Text = Dialog.Path

End

Public Sub About_Click()

Acerca.Show

End

Public Sub Exit_Click()

Me.close

End

Public Sub OpenFile_Click()

If Dialog.OpenFile() Then Return
  AbrirArchivo.Text = Dialog.Path

End


Public Sub Estado_MouseDown()

  

End
